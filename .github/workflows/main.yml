name: "Test"

on:
  push:
    inputs:
      test_input:
        description: "blah"
        required: true
        default: "abc,def,ghi"
  workflow_dispatch:
    inputs:
      test_input:
        description: "blah"
        required: true
        default: "abc,def,ghi"

jobs:
  split-input:
    runs-on: ubuntu-latest
    name: Split input
    steps:
      - shell: bash
        run: |
          echo scopes=`echo ${{ inputs.test_input }} | jq -R 'split(",")'` >> $GITHUB_ENV
  test-job:
    runs-on: ubuntu-latest
    needs: split-input
    strategy:
      max-parallel: 1
      matrix:
        scope: ${{ fromJSON(${{ env.scopes }}) }}
    name: "${{ matrix.scope }}"
    steps:
      - shell: bash
        run: |
          echo ${{ matrix.scope }}
